{"id":"b3xt","dependencies":[{"name":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/tsconfig.json","includedInParent":true,"mtime":1643795667867},{"name":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/package.json","includedInParent":true,"mtime":1643795667811},{"name":"tslib","loc":{"line":4,"column":24},"parent":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/src/wasm/barretenberg_wasm.ts","resolved":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/tslib/tslib.es6.js"},{"name":"fs","loc":{"line":5,"column":21},"parent":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/src/wasm/barretenberg_wasm.ts","resolved":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/parcel-bundler/src/builtins/_empty.js"},{"name":"detect-node","loc":{"line":6,"column":59},"parent":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/src/wasm/barretenberg_wasm.ts","resolved":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/detect-node/browser.js"},{"name":"util","loc":{"line":72,"column":73},"parent":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/src/wasm/barretenberg_wasm.ts","resolved":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/util/util.js"},{"name":"events","loc":{"line":8,"column":25},"parent":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/src/wasm/barretenberg_wasm.ts","resolved":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/events/events.js"},{"name":"debug","loc":{"line":9,"column":53},"parent":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/src/wasm/barretenberg_wasm.ts","resolved":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/debug/src/browser.js"},{"name":"../crypto/random","loc":{"line":10,"column":25},"parent":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/src/wasm/barretenberg_wasm.ts","resolved":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/src/crypto/random/index.ts"},{"name":"../fifo","loc":{"line":11,"column":23},"parent":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/src/wasm/barretenberg_wasm.ts","resolved":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/src/fifo/index.ts"},{"name":"buffer","parent":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/src/wasm/barretenberg_wasm.ts","resolved":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/node-libs-browser/node_modules/buffer/index.js"}],"generated":{"js":"var __dirname = \"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/src/wasm\";\nvar Buffer = require(\"buffer\").Buffer;\nvar e=\"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/src/wasm\",t=require(\"buffer\").Buffer;Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.BarretenbergWasm=exports.fetchCode=void 0;const r=require(\"tslib\"),i=require(\"fs\"),s=(0,r.__importDefault)(require(\"detect-node\")),n=require(\"util\"),a=require(\"events\"),o=(0,r.__importDefault)(require(\"debug\")),m=require(\"../crypto/random\"),u=require(\"../fifo\");async function c(){if(s.default)return await(0,n.promisify)(i.readFile)(e+\"/barretenberg.wasm\");{const e=await fetch(\"/barretenberg.wasm\");return t.from(await e.arrayBuffer())}}a.EventEmitter.defaultMaxListeners=30,exports.fetchCode=c;class l extends a.EventEmitter{constructor(){super(),this.mutexQ=new u.MemoryFifo,this.mutexQ.put(!0)}static async new(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"wasm\",t=arguments.length>1?arguments[1]:void 0;const r=new l;return r.on(\"log\",(0,o.default)(\"bb:\".concat(e))),await r.init(void 0,t),r}async init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256;this.emit(\"log\",\"intial mem: \".concat(t)),this.memory=new WebAssembly.Memory({initial:t,maximum:65536}),this.heap=new Uint8Array(this.memory.buffer);const r={wasi_snapshot_preview1:{environ_get:()=>{},environ_sizes_get:()=>{},fd_close:()=>{},fd_read:()=>{},fd_write:()=>{},fd_seek:()=>{},fd_fdstat_get:()=>{},fd_fdstat_set_flags:()=>{},path_open:()=>{},path_filestat_get:()=>{},proc_exit:()=>{},random_get:(e,t)=>{e>>>=0;const r=new Uint8Array(this.memory.buffer),i=(0,m.getRandomBytes)(t);for(let s=e;s<e+t;++s)r[s]=i[s-e]}},module:{},env:{logstr:e=>{e>>>=0;const t=this.getMemory();let r=e;for(;0!==t[r];++r);const i=(s.default?new(require(\"util\").TextDecoder):new TextDecoder).decode(t.slice(e,r)),n=\"\".concat(i,\" (mem:\").concat(t.length,\")\");this.emit(\"log\",n)},memory:this.memory}};if(e)this.instance=await WebAssembly.instantiate(e,r),this.module=e;else{const{instance:e,module:t}=await WebAssembly.instantiate(await c(),r);this.instance=e,this.module=t}}exports(){return this.instance.exports}call(e){if(!this.exports()[e])throw new Error(\"WASM function \".concat(e,\" not found.\"));for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return this.exports()[e](...r)>>>0}getMemory(){return 0===this.heap.length?new Uint8Array(this.memory.buffer):this.heap}sliceMemory(e,t){return this.getMemory().slice(e,t)}transferToHeap(e,t){const r=this.getMemory();for(let i=0;i<e.length;i++)r[i+t]=e[i]}async acquire(){await this.mutexQ.get()}async release(){if(0!==this.mutexQ.length())throw new Error(\"Release called but not acquired.\");this.mutexQ.put(!0)}}exports.BarretenbergWasm=l;"},"sourceMaps":null,"error":null,"hash":"4b4e51efaabd320c69ffa8d8d4469af8","cacheData":{"env":{}}}